include /icon/icon.pug
include /permalink/permalink.pug

mixin variationheader(variation)
  - const variationId = h.dasherize(variation.id)
  - const actionlistId = `${h.dasherize(variation.id)}-actionlist`
  - const component = components[variation.componentId]
  header.variationheader&attributes(attributes)
    .wrap.wrap--content
      div.variationheader__meta
        span.variationheader__naming= h.t('variation.naming')
        if variation.status
          span.variationheader__status= variation.status
        if variation.label
          span.variationheader__label= variation.label

      h2.variationheader__title= variation.title

      nav.variationheader__links
        if variation.rendered
          +variationheaderLink(`${variationId}-preview`, h.t('variation.preview'), true)
        if variation.raw || variation.context || variation.rendered
          +variationheaderLink(`${variationId}-code`, h.t('variation.code'), !variation.rendered)

      .variationheader__actions
        button.variationheader__actiontoggle(type="button" data-actionlist-target=actionlistId)
          +icon('sheet')

        ul.variationheader__actionlist(id=actionlistId)
          li.variationheader__action
            +permalink(h.t('variation.copy_permalink'), `#${variationId}`, 'globe').variationheader__actionlink
          li.variationheader__action
            a.variationheader__actionlink(href=h.variationPreviewPath(variation.id) target=variationId)
              +icon('open-in-window')
              = h.t('variation.open_in_window')

mixin variationheaderLink(id, title, active)
  - const classes = active ? 'variationheader__link--active' : null
  a.variationheader__link(href=`#${id}` class=classes)= title
